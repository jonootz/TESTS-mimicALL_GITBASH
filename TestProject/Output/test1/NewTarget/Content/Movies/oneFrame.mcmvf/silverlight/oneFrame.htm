<!DOCTYPE html>
<html data-mc-ignore="true">
    <head>
        <title>oneFrame</title>
        <script type="text/javascript" src="Silverlight.js">
        </script>
        <script type="text/javascript">/*<![CDATA[*/
String.IsNullOrEmpty=function(a){if(a==null){return true}if(a.length==0){return true}return false};String.prototype.StartsWith=function(d,b){if(d==null){return false}if(this.length<d.length){return false}var c=this;var a=d;if(!b){c=c.toLowerCase();a=a.toLowerCase()}if(c.substring(0,a.length)==a){return true}else{return false}};function CMCXmlParser(){}CMCXmlParser._FilePathToXmlStringMap=new CMCDictionary();CMCXmlParser._LoadingFilesPathMap=new CMCDictionary();CMCXmlParser._LoadingFromQueue=false;CMCXmlParser.GetXmlDoc=function(k,d,b,f,c){function j(){CMCXmlParser._LoadingFilesPathMap.Remove(h.FullPath);var m=CMCXmlParser._FilePathToXmlStringMap.GetItem(h.Name);CMCXmlParser._FilePathToXmlStringMap.Remove(h.FullPath);l=m;CMCXmlParser._LoadingFilesPathMap.ForEach(function(p,q){var o=new CMCUrl(p);var n=q;if(o.Name==e&&o.FullPath!=h.FullPath){CMCXmlParser._LoadingFilesPathMap.Remove(o.FullPath);CMCXmlParser._LoadingFromQueue=true;CMCXmlParser.GetXmlDoc(o.FullPath,n.async,n.LoadFunc,n.args,n.loadContextObj);return false}return true});if(c==null){b(l,f)}else{b.call(c,l,f)}}var l=null;var g=new CMCUrl(k);var h=g.ToExtension("js");var e=h.Name;CMCXmlParser._LoadingFilesPathMap.Add(h.FullPath,{async:d,LoadFunc:b,args:f,loadContextObj:c});var i=false;CMCXmlParser._LoadingFilesPathMap.ForEach(function(o,p){var n=new CMCUrl(o);var m=p;if(n.Name==e&&n.FullPath!=h.FullPath){i=true;return false}return true});if(CMCXmlParser._LoadingFromQueue||!i){CMCXmlParser._LoadingFromQueue=false;var a=document.createElement("script");a.src=h.FullPath;a.type="text/javascript";a.onreadystatechange=function(){if(a.readyState=="loaded"||a.readyState=="complete"){j()}};a.onload=function(){j()};document.getElementsByTagName("head")[0].appendChild(a)}return l};CMCXmlParser.LoadXmlString=function(b){var a=null;if(window.ActiveXObject){a=CMCXmlParser.GetMicrosoftXmlDomObject();a.async=false;a.loadXML(b)}else{if(DOMParser){var c=new DOMParser();a=c.parseFromString(b,"text/xml")}}return a};CMCXmlParser.CreateXmlDocument=function(a){var b="<"+a+" />";var c=CMCXmlParser.LoadXmlString(b);return c};CMCXmlParser.GetOuterXml=function(c){var a=null;if(window.ActiveXObject){a=c.xml}else{if(window.XMLSerializer){var b=new XMLSerializer();a=b.serializeToString(c)}}return a};CMCXmlParser.CallWebService=function(d,c,e,a){var b=new CMCXmlParser(a,e,null);var f=b.LoadRemote(d,c);return f};function CMCDictionary(){this.mMap=new Object();this.mOverflows=new Array();this.mLength=0}CMCDictionary.prototype.GetLength=function(a){return this.mLength};CMCDictionary.prototype.ForEach=function(e){var h=this.mMap;for(var b in h){var f=h[b];if(!e(b,f)){return}}var g=this.mOverflows;for(var a=0,d=g.length;a<d;a++){var c=g[a];if(!e(c.Key,c.Value)){return}}};CMCDictionary.prototype.GetItem=function(b){var c=null;if(typeof(this.mMap[b])=="function"){var a=this.GetItemOverflowIndex(b);if(a>=0){c=this.mOverflows[a].Value}}else{c=this.mMap[b];if(typeof(c)=="undefined"){c=null}}return c};CMCDictionary.prototype.GetItemOverflowIndex=function(b){var d=this.mOverflows;for(var a=0,c=d.length;a<c;a++){if(d[a].Key==b){return a}}return -1};CMCDictionary.prototype.Remove=function(b){if(typeof(this.mMap[b])=="function"){var a=this.GetItemOverflowIndex(b);if(a>=0){this.mOverflows.splice(a,1);this.mLength--}}else{if(this.mMap[b]!="undefined"){delete (this.mMap[b]);this.mLength--}}};CMCDictionary.prototype.Add=function(a,c){if(typeof(this.mMap[a])=="function"){var b=this.GetItem(a);if(b!=null){this.Remove(a)}this.mOverflows[this.mOverflows.length]={Key:a,Value:c}}else{this.mMap[a]=c}this.mLength++};CMCDictionary.prototype.AddUnique=function(a,c){var b=this.GetItem(a);if(typeof(b)=="undefined"||!b){this.Add(a,c)}};function CMCUrl(b){var a=this;this.FullPath=null;this.Path=null;this.PlainPath=null;this.Name=null;this.Extension=null;this.NameWithExtension=null;this.Fragment=null;this.Query=null;this.IsAbsolute=false;(function(){var i="";var k="";var j=b.indexOf("#");var g=b.indexOf("?");if(j!=-1){if(j>g){i=b.substring(j)}else{i=b.substring(j,g)}}if(g!=-1){if(g>j){k=b.substring(g)}else{k=b.substring(g,j)}}var l=Math.max(j,g);var h=b.substring(0,l==-1?b.length:l);l=h.lastIndexOf("/");var m=h.substring(0,l+1);var f=h.substring(l+1);l=f.lastIndexOf(".");var c=f.substring(0,l);var e=f.substring(l+1);var d="";l=b.indexOf(":");if(l>=0){d=b.substring(0,l)}a.FullPath=b;a.Path=m;a.PlainPath=h;a.Name=c;a.Extension=e;a.NameWithExtension=f;a.Scheme=d;a.IsAbsolute=!String.IsNullOrEmpty(d);a.Fragment=i;a.Query=k})()}CMCUrl.prototype.AddFile=function(d){if(typeof(d)=="string"){d=new CMCUrl(d)}if(d.IsAbsolute){return d}var c=d.FullPath;if(c.charAt(0)=="/"){var e=document.location;var f=e.href.lastIndexOf(e.pathname);var b=e.href.substring(0,f);return new CMCUrl(b+c)}var a=this.FullPath;if(!a.EndsWith("/")){a=a+"/"}return new CMCUrl(a+c)};CMCUrl.prototype.CombinePath=function(g){if(typeof(g)=="string"){g=new CMCUrl(g)}if(g.IsAbsolute){throw new CMCException(-1,"Cannot combine two absolute paths.")}var e=g.FullPath;var b=this.FullPath;var f=g.FullPath.split("/");var k=this.FullPath;var h="";if(this.Scheme=="mk"){var j=k.indexOf("::");h=k.substring(0,j+"::".length);k=k.substring(j+"::".length)}for(var d=0,a=f.length;d<a;d++){var c=f[d];if(String.IsNullOrEmpty(c)){continue}if(k.length>1&&k.EndsWith("/")){k=k.substring(0,k.length-1)}if(c=="."){k+="/"}else{if(c==".."){k=k.substring(0,k.lastIndexOf("/")+1)}else{if(!k.EndsWith("/")){k+="/"}k+=c}}}k=h+k;return new CMCUrl(k)};CMCUrl.prototype.ToQuery=function(b){var a=this.PlainPath+"?"+b+this.Fragment;return new CMCUrl(a)};CMCUrl.prototype.ToFolder=function(){var a=this.PlainPath;var c=a.lastIndexOf("/");var b=a.substring(0,c+1);return new CMCUrl(b)};CMCUrl.prototype.ToRelative=function(c){var d=c.FullPath;var a=this.FullPath;var e=a.indexOf(d);var b=null;if(e==0){b=a.substring(d.length)}else{b=a}return new CMCUrl(b)};CMCUrl.prototype.ToExtension=function(e){var c=this.FullPath;var d=c.lastIndexOf(".");var b=c.substring(0,d);var a=b+"."+e;return new CMCUrl(a)};var Enum=new Object();var Helper={GetDefaultInputId:function(){return"MimicInputForm"},GetLoadingCanvasName:function(){return"Loading"},GetLoadingAnimationName:function(){return"Loading_Animation"},GetFrameName:function(a){return"Frame_"+a},GetFrameBackgroundName:function(a,b){return a+"_Background_"+b},GetSoundObjectName:function(b,a){return b+"_SoundObject_"+a},GetShapeName:function(a,b){return a+"_Shape_"+b},GetFrameBackgroundTimerName:function(a){return a+"_BackgroundTimer"},GetNormalStateName:function(a){return a+"_Normal"},GetPressedStateName:function(a){return a+"_Pressed"},GetHoverStateName:function(a){return a+"_Hover"},GetTextName:function(a){return"Text_"+a},GetAnimationName:function(a){return a+"_Animation"},GetInEffectName:function(a){return a+"_In"},GetOutEffectName:function(a){return a+"_Out"},GetInOutEffectName:function(a){return a+"_InOut"},GetSoundName:function(a){if(a==null){return"Sound"}else{return a+"_Sound"}},GetVideoName:function(a){return a+"_Video"},GetPooledSoundName:function(b,a){return b+"_Sound_"+a},ExtractFrameName:function(c){var b=/Frame_\d+/;var a=b.exec(c);return a[0]},ExtractShapeName:function(a){var c=/Frame_\d+_Shape_\d+/;var b=c.exec(a);return b[0]},ExtractSoundObjectName:function(b){var c=/Frame_\d+_SoundObject_\d+/;var a=c.exec(b);return a[0]},GetObjectInfo:function(object){if(object==null||object.Tag==null){return null}return eval("({"+object.Tag+"})")},IsOnline:function(){return document.location.protocol=="http:"||document.location.protocol=="https:"},AlignText:function(c,a){var b=c.GetParent();switch(a){case"Near":c["Canvas.Top"]="0";break;case"Far":c["Canvas.Top"]=b.Height-c.ActualHeight;break;case"Center":c["Canvas.Top"]=(b.Height-c.ActualHeight)/2;break}},ReplayMediaElement:function(a){a.Stop();a.Play()}};function Variables(){}Variables.prototype.Add=function(b,a){if(this.variables==null){this.variables=new Array()}this.variables[b]=new Object();this.variables[b].defaultValue=a;this.variables[b].value=a};Variables.prototype.AssertExists=function(a){if(this.variables==null||this.variables[a]==null){throw'Variable "'+a+'" not found!'}};Variables.prototype.Set=function(b,a){this.AssertExists(b);this.variables[b].value=a;return this.variables[b].value};Variables.prototype.Increment=function(a){this.AssertExists(a);this.variables[a].value++;return this.variables[a].value};Variables.prototype.Decrement=function(a){this.AssertExists(a);this.variables[a].value--;return this.variables[a].value};Variables.prototype.Get=function(a){this.AssertExists(a);return this.variables[a].value};Variables.prototype.Reset=function(){var a;for(a in this.variables){this.variables[a].value=this.variables[a].defaultValue}};Enum.PlayableType={MediaElement:0,Storyboard:1};Enum.PlayableState={Active:0,Paused:1,Stopped:2};function Playables(){}Playables.prototype.AssertExists=function(a){if(this.playables==null||this.playables[a]==null){throw'Object "'+a+'" not found!'}};Playables.prototype.Count=function(){if(this.playables==null){return 0}return this.playables.length};Playables.prototype.Get=function(b){var a;try{this.AssertExists(b)}catch(a){return null}return this.playables[b].object};Playables.prototype.RemoveAll=function(){var a;if(this.playables==null){return}for(a in this.playables){delete this.playables[a]}};Playables.prototype.Remove=function(b){var a;try{this.AssertExists(b)}catch(a){return false}delete this.playables[b];return true};Playables.prototype.RemoveFrom=function(a){var b;if(this.playables==null){return}for(b in this.playables){a.Remove(b)}};Playables.prototype.AddTo=function(b){var c;var a;if(this.playables==null){return}for(c in this.playables){a=this.playables[c];b.Add(a.object,a.type,c,a.state)}};Playables.prototype.Add=function(c,b,e,a){var d;if(c==null||b==null){return}d=new Object();d.type=b;d.object=c;if(a==null){d.state=Enum.PlayableState.Stopped}else{d.state=a}if(this.playables==null){this.playables=new Array()}if(e==null){this.playables.push(d)}else{this.playables[e]=d}};Playables.prototype.AddMediaElement=function(b,c,a){this.Add(b,Enum.PlayableType.MediaElement,c,a)};Playables.prototype.AddStoryboard=function(b,c,a){this.Add(b,Enum.PlayableType.Storyboard,c,a)};Playables.prototype.TrySeek=function(c,b){var a;if(c==null){for(c in this.playables){this.TryFastForward(c,b)}return true}else{try{this.AssertExists(c)}catch(a){return false}switch(this.playables[c].type){case Enum.PlayableType.MediaElement:throw"Functionality not yet implemented!";break;case Enum.PlayableType.Storyboard:if(this.TryBegin(c)==false){return false}this.playables[c].object.Seek(b);break}return true}};Playables.prototype.TryBegin=function(b){var a;if(b==null){for(b in this.playables){this.TryBegin(b)}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].type){case Enum.PlayableType.MediaElement:Helper.ReplayMediaElement(this.playables[b].object);this.playables[b].state=Enum.PlayableState.Active;break;case Enum.PlayableType.Storyboard:this.playables[b].object.Stop();this.playables[b].object.Begin();this.playables[b].state=Enum.PlayableState.Active;break}return true}};Playables.prototype.TryStop=function(b){var a;if(b==null){for(b in this.playables){this.TryStop(b)}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].type){case Enum.PlayableType.MediaElement:case Enum.PlayableType.Storyboard:try{this.playables[b].object.Stop()}catch(a){return false}this.playables[b].state=Enum.PlayableState.Stopped;break}return true}};Playables.prototype.TryPause=function(b){var a;if(b==null){for(b in this.playables){this.TryPause(b)}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].type){case Enum.PlayableType.MediaElement:case Enum.PlayableType.Storyboard:this.playables[b].object.Pause();this.playables[b].state=Enum.PlayableState.Paused;break}return true}};Playables.prototype.TryResume=function(b){var a;if(b==null){for(b in this.playables){this.TryResume(b)}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].type){case Enum.PlayableType.MediaElement:this.playables[b].object.Play();this.playables[b].state=Enum.PlayableState.Active;break;case Enum.PlayableType.Storyboard:this.playables[b].object.Resume();this.playables[b].state=Enum.PlayableState.Active;break}return true}};Playables.prototype.TryTogglePause=function(b){var a;if(b==null){for(b in this.playables){this.TryTogglePause(b)}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].state){case Enum.PlayableState.Active:this.TryPause(b);break;case Enum.PlayableState.Paused:this.TryResume(b);break}return true}};Playables.prototype.IsPaused=function(a){if(a==null){for(a in this.playables){if(!this.IsPaused(a)){return false}}return true}else{this.AssertExists(a);return this.playables[a].state==Enum.PlayableState.Paused}};Playables.prototype.IsReady=function(b){if(b==null){for(b in this.playables){if(!this.IsReady(b)){return false}}return true}else{try{this.AssertExists(b)}catch(a){return false}switch(this.playables[b].type){case Enum.PlayableType.MediaElement:return(this.playables[b].object.DownloadProgress>=1);break;case Enum.PlayableType.Storyboard:return true;break;default:throw"Unknown playable object type"}throw"Unreachable code reached!"}};Enum.ShapeType={Cursor:"CursorOvalShape",TypingBox:"TypingBoxShape",InputBox:"InputBoxShape",Rollover:"RolloverCaptionBubbleShape",InputHint:"InputHintCaptionBubbleShape",InputSuccess:"InputSuccessCaptionBubbleShape",InputFailure:"InputFailureCaptionBubbleShape",Button:"ButtonShape"};Enum.ActionType={Action:0,End:1,Failure:2};function Shape(c,e){var b;var a;var d;this.variables=new Variables();this.animations=new Playables();this.sounds=new Playables();this.canvas=e.canvas.FindName(c);if(this.canvas!=null){d=Helper.GetObjectInfo(this.canvas);this.type=d.type;this.variables.Add("ShapeAnimated",false);this.callouts=new Array();this.cursors=new Array();this.inputs=new Array();this.actions=new Array();a=Helper.GetAnimationName(c);this.animations.AddStoryboard(this.canvas.FindName(a),"ShapeAnimation");a=Helper.GetSoundName(c);this.sounds.AddMediaElement(this.canvas.FindName(a),a);for(b in d.callouts){a=Helper.GetShapeName(e.canvas.Name,d.callouts[b]);this.callouts.push(e.Shape(a))}for(b in d.cursors){a=Helper.GetShapeName(e.canvas.Name,d.cursors[b]);this.cursors.push(e.Shape(a))}for(b in d.inputs){a=Helper.GetShapeName(e.canvas.Name,d.inputs[b]);this.inputs.push(e.Shape(a))}if(d.action!=null){this.actions[Enum.ActionType.Action]=new Object();this.actions[Enum.ActionType.Action].func=d.action;this.actions[Enum.ActionType.Action].arg=d.actionArg}if(d.endAction!=null){this.actions[Enum.ActionType.End]=new Object();this.actions[Enum.ActionType.End].func=d.endAction;this.actions[Enum.ActionType.End].arg=d.endActionArg}if(d.actOnDblClick==true){this.actionOnDoubleClick=true}else{this.actionOnDoubleClick=false}switch(this.type){case Enum.ShapeType.TypingBox:this.InitTypingBox(c,d);break;case Enum.ShapeType.InputBox:this.InitInputBox(d,e);break;case Enum.ShapeType.Button:this.InitButton(c);break;case Enum.ShapeType.InputSuccess:case Enum.ShapeType.InputFailure:a=Helper.GetInOutEffectName(c);this.animations.AddStoryboard(this.canvas.FindName(a),"InOutEffect");break;case Enum.ShapeType.Rollover:case Enum.ShapeType.InputHint:a=Helper.GetInEffectName(c);this.animations.AddStoryboard(this.canvas.FindName(a),"InEffect");a=Helper.GetOutEffectName(c);this.animations.AddStoryboard(this.canvas.FindName(a),"OutEffect");break}}}Shape.prototype.AssertType=function(a){if(this.type!=a){throw"Type mismatch: "+this.type+" is not a "+a+"!"}};Shape.prototype.Stop=function(){this.animations.TryStop();switch(this.type){case Enum.ShapeType.Button:this.ResetButton();break;case Enum.ShapeType.TypingBox:this.ResetTypingBox();break;case Enum.ShapeType.InputBox:this.ResetInputBox();break}this.variables.Reset()};Shape.prototype.TogglePauseAnimations=function(){this.animations.TryTogglePause()};Shape.prototype.BeginShapeAnimation=function(){if(this.variables.Get("ShapeAnimated")!=true){this.animations.TryBegin("ShapeAnimation");this.variables.Set("ShapeAnimated",true)}};Shape.prototype.ShowCallouts=function(){var a;for(a in this.callouts){this.callouts[a].animations.TryBegin("InEffect");this.callouts[a].BeginShapeAnimation()}};Shape.prototype.HideCallouts=function(){var a;for(a in this.callouts){this.callouts[a].animations.TryBegin("OutEffect")}};Shape.prototype.DoAction=function(b){var d;var c;var a;try{c=this.actions[b].func;a=this.actions[b].arg}catch(d){return}switch(c){default:Movie.DoAction(c,a);break;case Enum.ActionFunc.Accept:this.AcceptInputs();break;case Enum.ActionFunc.StartCursor:for(i in this.cursors){this.cursors[i].BeginShapeAnimation()}break}};Shape.prototype.AcceptInputs=function(){var b;var c;var d=null;var a=true;for(b in this.inputs){if(!this.inputs[b].InputIsCorrect()){a=false;c=this.inputs[b]}this.inputs[b].DecrementAttemptsRemaining();if(this.inputs[b].OutOfAttempts()){d=this.inputs[b]}}if(this.inputs.length>0){if(a){for(b in this.inputs){this.inputs[b].DisableInput()}this.inputs[0].OnInputSucceeded()}else{if(d!=null){for(b in this.inputs){this.inputs[b].DisableInput()}d.OnInputFailedAtLast()}else{c.ShowFailureMessages();c.StartInput()}}}};Shape.prototype.OnShapeAnimationCompleted=function(){this.DoAction(Enum.ActionType.End)};Shape.prototype.OnCursorClick=function(){this.AssertType(Enum.ShapeType.Cursor);this.sounds.TryBegin()};Shape.prototype.OnMouseLeftDown=function(){switch(this.type){case Enum.ShapeType.InputBox:this.OnInputBoxMouseLeftDown();break;case Enum.ShapeType.Button:this.OnButtonMouseLeftDown();break}};Shape.prototype.OnMouseLeftUp=function(){var a;switch(this.type){case Enum.ShapeType.InputBox:break;case Enum.ShapeType.Button:this.OnButtonMouseLeftUp();default:if(this.actionOnDoubleClick==true){a=(new Date()).getTime();if(a-500<this.lastClickedTime){this.DoAction(Enum.ActionType.Action);this.lastClickedTime=null}else{this.lastClickedTime=a}}else{this.DoAction(Enum.ActionType.Action)}break}};Shape.prototype.OnMouseEnter=function(){switch(this.type){case Enum.ShapeType.Button:this.OnButtonMouseEnter();default:this.ShowCallouts();break}};Shape.prototype.OnMouseLeave=function(){switch(this.type){case Enum.ShapeType.Button:this.OnButtonMouseLeave();default:this.HideCallouts();break}};Shape.prototype.InitInputBox=function(d,c){var b;var a;this.AssertType(Enum.ShapeType.InputBox);this.inputTextBlock=this.canvas.Children.GetItem(0).Children.GetItem(1).Children.GetItem(0);this.vAlign=this.inputTextBlock.Tag.split(" ")[0];this.textColor=this.inputTextBlock.Tag.split(" ")[1];if(this.callouts==null){this.callouts=new Array()}this.successes=new Array();this.failures=new Array();this.startText=this.inputTextBlock.Text;this.entries=d.entries;this.variables.Add("AttemptsRemaining",d.attempts);for(b in d.hints){a=Helper.GetShapeName(c.canvas.Name,d.hints[b]);this.callouts.push(c.Shape(a))}for(b in d.successes){a=Helper.GetShapeName(c.canvas.Name,d.successes[b]);this.successes.push(c.Shape(a))}for(b in d.failures){a=Helper.GetShapeName(c.canvas.Name,d.failures[b]);this.failures.push(c.Shape(a))}if(d.failureAction!=null){this.actions[Enum.ActionType.Failure]=new Object();this.actions[Enum.ActionType.Failure].func=d.failureAction;this.actions[Enum.ActionType.Failure].arg=d.failureActionArg}};Shape.prototype.ResetInputBox=function(){this.AssertType(Enum.ShapeType.InputBox);this.StopInput();this.inputTextBlock.Text=this.startText};Shape.prototype.DisableInput=function(){this.AssertType(Enum.ShapeType.InputBox);this.variables.Set("AttemptsRemaining",0)};Shape.prototype.OutOfAttempts=function(){this.AssertType(Enum.ShapeType.InputBox);return this.variables.Get("AttemptsRemaining")==0};Shape.prototype.StartInput=function(){var d;var c;var b;var a;this.AssertType(Enum.ShapeType.InputBox);if(!this.OutOfAttempts()){d=this.canvas;c=this.inputTextBlock;b=Movie.htmlInputForm;a=Movie.HtmlInputField();b.style.left=(d["Canvas.Left"]+c.GetParent()["Canvas.Left"])+"px";b.style.top=(d["Canvas.Top"])+"px";b.style.height=d.Height+"px";b.id=d.Name;a.onblur=Movie.OnInputFieldBlur;a.style.width=d.Width+"px";a.style.bottom=((d.Height-c.FontSize)/2)+"px";a.style.color=this.textColor;a.style.fontFamily=c.FontFamily;a.style.fontSize=c.FontSize+"px";a.style.fontStyle=c.FontStyle.toLowerCase();a.style.fontWeight=c.FontWeight.toLowerCase();a.value=c.Text;c.Text="";b.style.display="";a.select();a.focus()}};Shape.prototype.StopInput=function(){var c;var a;var b;this.AssertType(Enum.ShapeType.InputBox);if(!this.OutOfAttempts()){c=this.inputTextBlock;a=Movie.HtmlInputField();c.Text=a.value;Helper.AlignText(c,this.vAlign)}b=Movie.htmlInputForm;b.style.display="none";b.id=Helper.GetDefaultInputId()};Shape.prototype.SubmitInput=function(){this.AssertType(Enum.ShapeType.InputBox);if(!this.OutOfAttempts()){if(this.InputIsCorrect()){this.StopInput();this.DisableInput();this.OnInputSucceeded()}else{this.DecrementAttemptsRemaining();if(this.OutOfAttempts()){this.StopInput();this.DisableInput();this.OnInputFailedAtLast()}else{this.ShowFailureMessages()}}}};Shape.prototype.InputIsCorrect=function(){var b;var a;this.AssertType(Enum.ShapeType.InputBox);if(!this.OutOfAttempts()){if(Movie.InputInProgress()){a=Movie.HtmlInputField().value}else{a=this.inputTextBlock.Text}for(b in this.entries){if(a==this.entries[b]){return true}}}return false};Shape.prototype.DecrementAttemptsRemaining=function(){var a;this.AssertType(Enum.ShapeType.InputBox);a=this.variables.Get("AttemptsRemaining");if(a!=0&&a!="infinite"){this.variables.Decrement("AttemptsRemaining")}};Shape.prototype.OnInputSucceeded=function(){var a;this.AssertType(Enum.ShapeType.InputBox);this.sounds.TryBegin();this.sounds.AddTo(Movie.playingSounds);if(this.successes!=null&&this.successes.length>0){this.AnticipateMessageCompletions();this.ShowSuccessMessages()}else{this.DoAction(Enum.ActionType.Action)}};Shape.prototype.OnInputFailedAtLast=function(){this.AssertType(Enum.ShapeType.InputBox);this.DoAction(Enum.ActionType.Failure)};Shape.prototype.AnticipateMessageCompletions=function(){this.AssertType(Enum.ShapeType.InputBox);this.HideFailureMessages();this.completedMessageCount=0;Movie.CurrentFrame().variables.Set("ShapeAwaitingMessageCompletion",this)};Shape.prototype.ShowSuccessMessages=function(){var a;this.AssertType(Enum.ShapeType.InputBox);for(a in this.successes){this.successes[a].animations.TryBegin("InOutEffect");this.successes[a].BeginShapeAnimation()}};Shape.prototype.ShowFailureMessages=function(){var a;this.AssertType(Enum.ShapeType.InputBox);for(a in this.failures){this.failures[a].animations.TryBegin("InOutEffect");this.failures[a].BeginShapeAnimation()}};Shape.prototype.HideFailureMessages=function(){var a;this.AssertType(Enum.ShapeType.InputBox);for(a in this.failures){this.failures[a].animations.TryStop("InOutEffect")}};Shape.prototype.OnInputBoxMouseLeftDown=function(){this.AssertType(Enum.ShapeType.InputBox);if(!Movie.InputInProgress()){this.StartInput()}};Shape.prototype.OnSuccessMessageCompleted=function(){this.AssertType(Enum.ShapeType.InputBox);this.completedMessageCount++;if(this.completedMessageCount>=this.successes.length){Movie.CurrentFrame().variables.Set("ShapeAwaitingMessageCompletion",null);this.DoAction(Enum.ActionType.Action)}};Enum.ButtonState={Normal:0,Hover:1,Pressed:2};Shape.prototype.InitButton=function(b){var a;this.AssertType(Enum.ShapeType.Button);this.states=new Array();a=Helper.GetNormalStateName(b);this.states[Enum.ButtonState.Normal]=this.canvas.FindName(a);a=Helper.GetHoverStateName(b);this.states[Enum.ButtonState.Hover]=this.canvas.FindName(a);a=Helper.GetPressedStateName(b);this.states[Enum.ButtonState.Pressed]=this.canvas.FindName(a)};Shape.prototype.ResetButton=function(){this.AssertType(Enum.ShapeType.Button);this.states[Enum.ButtonState.Normal].visibility="Visible";this.states[Enum.ButtonState.Hover].visibility="Collapsed";this.states[Enum.ButtonState.Pressed].visibility="Collapsed"};Shape.prototype.OnButtonMouseLeftDown=function(){this.AssertType(Enum.ShapeType.Button);this.states[Enum.ButtonState.Normal].visibility="Collapsed";this.states[Enum.ButtonState.Hover].visibility="Collapsed";this.states[Enum.ButtonState.Pressed].opacity="1";this.states[Enum.ButtonState.Pressed].visibility="Visible"};Shape.prototype.OnButtonMouseLeftUp=function(){this.AssertType(Enum.ShapeType.Button);this.sounds.TryBegin();this.sounds.AddTo(Movie.playingSounds);this.states[Enum.ButtonState.Normal].visibility="Collapsed";this.states[Enum.ButtonState.Hover].opacity="1";this.states[Enum.ButtonState.Hover].visibility="Visible";this.states[Enum.ButtonState.Pressed].visibility="Collapsed"};Shape.prototype.OnButtonMouseEnter=function(){this.AssertType(Enum.ShapeType.Button);this.states[Enum.ButtonState.Normal].visibility="Collapsed";this.states[Enum.ButtonState.Hover].opacity="1";this.states[Enum.ButtonState.Hover].visibility="Visible";this.states[Enum.ButtonState.Pressed].visibility="Collapsed"};Shape.prototype.OnButtonMouseLeave=function(){this.AssertType(Enum.ShapeType.Button);this.states[Enum.ButtonState.Normal].visibility="Visible";this.states[Enum.ButtonState.Hover].visibility="Collapsed";this.states[Enum.ButtonState.Pressed].visibility="Collapsed"};Shape.prototype.InitTypingBox=function(c,e){var a;this.AssertType(Enum.ShapeType.TypingBox);var b;for(b=0;;b++){a=Helper.GetPooledSoundName(c,b);var d=this.canvas.FindName(a);if(d==null){break}this.sounds.AddMediaElement(d)}this.typingTextBlock=this.canvas.Children.GetItem(0).Children.GetItem(1).Children.GetItem(0);this.vAlign=this.typingTextBlock.Tag.split(" ")[0];this.startText=this.typingTextBlock.Text;this.duration=e.duration;this.variables.Add("TextToType",e.typedText);this.variables.Add("IsTyping",false)};Shape.prototype.ResetTypingBox=function(){this.AssertType(Enum.ShapeType.TypingBox);this.typingTextBlock.Text=this.startText};Shape.prototype.BeginTyping=function(){var a=new Date().getTime();this.typingEndTime=a+this.duration;this.variables.Set("IsTyping",true);this.UpdateTyping()};Shape.prototype.UpdateTyping=function(){var c;var a;var e;var d;var b;this.AssertType(Enum.ShapeType.TypingBox);if(this.variables.Get("IsTyping")!=true){return}c=this.variables.Get("TextToType");if(c.length>1){e=new Date().getTime();d=(this.typingEndTime-e)/c.length;b=this;setTimeout(function(){b.UpdateTyping()},d)}this.sounds.TryBegin(c.length%this.sounds.Count());a=c.substr(0,1);this.typingTextBlock.Text+=a;Helper.AlignText(this.typingTextBlock,this.vAlign);c=c.substr(1);this.variables.Set("TextToType",c)};function Frame(g,b){var e;var c;var f;var a;var d;this.variables=new Variables();this.backgroundSounds=new Playables();this.soundObjects=new Playables();this.videos=new Playables();this.animations=new Playables();c=Helper.GetFrameName(g);this.canvas=b.FindName(c);if(g!=0&&this.canvas!=null){f=Helper.GetObjectInfo(this.canvas);this.stopPreviousSound=f.stopprevsnd;this.nearEnd=f.nearend;c=Helper.GetAnimationName(this.canvas.Name);this.animations.AddStoryboard(this.canvas.FindName(c),c);c=Helper.GetSoundName(this.canvas.Name);this.backgroundSounds.AddMediaElement(this.canvas.FindName(c),c);c=Helper.GetVideoName(this.canvas.Name);this.videos.AddMediaElement(this.canvas.FindName(c),c);for(e=0;;e++){c=Helper.GetSoundObjectName(this.canvas.Name,e);a=this.canvas.FindName(c);if(a==null){break}this.soundObjects.AddMediaElement(a,c)}this.backgrounds=new Array();for(e=0;;e++){c=Helper.GetFrameBackgroundName(this.canvas.Name,e);d=this.canvas.FindName(c);if(d==null){break}this.backgrounds.push(d)}if(this.backgrounds.length>0){c=Helper.GetFrameBackgroundTimerName(this.canvas.Name);this.animations.AddStoryboard(this.canvas.FindName(c),"BackgroundUpdateTimer");this.variables.Add("CurrentBackgroundIndex",0)}this.variables.Add("ShapeAwaitingMessageCompletion",null)}}Frame.prototype.Owns=function(b){var a=this.canvas.Name;var c=b.substr(0,a.length);return(c==a)};Frame.prototype.ShowEnd=function(){var a=Helper.GetAnimationName(this.canvas.Name);this.animations.TrySeek(a,this.nearEnd);this.animations.TryPause(a);this.Show()};Frame.prototype.Show=function(){this.canvas.visibility="Visible"};Frame.prototype.Hide=function(){this.canvas.visibility="Collapsed"};Frame.prototype.Start=function(){if(!this.videos.IsReady()||!this.backgroundSounds.IsReady()||!this.soundObjects.IsReady()){Movie.BeginLoadingAnimation();var a=this;setTimeout(function(){a.Start()},100)}else{Movie.TryEndLoadingAnimation()}this.animations.TryBegin();this.videos.TryBegin();this.backgroundSounds.TryBegin();this.backgroundSounds.AddTo(Movie.playingSounds);this.backgroundSounds.AddTo(Movie.previousFramesSounds)};Frame.prototype.Stop=function(){var b;var a;if(this.backgrounds!=null&&this.backgrounds.length>0){this.backgrounds[this.variables.Get("CurrentBackgroundIndex")].visibility="Collapsed";this.backgrounds[0].visibility="Visible"}this.StopShapes();this.animations.TryStop();this.videos.TryStop();this.variables.Reset()};Frame.prototype.TogglePauseAnimations=function(){var a;for(a in this.shapes){this.shapes[a].TogglePauseAnimations()}this.animations.TryTogglePause();this.videos.TryTogglePause()};Frame.prototype.Shape=function(a){if(!this.Owns(a)){return null}if(this.shapes==null){this.shapes=new Array();this.shapes[a]=new Shape(a,this)}else{if(this.shapes[a]==null){this.shapes[a]=new Shape(a,this)}}return this.shapes[a]};Frame.prototype.StopShapes=function(){var a;for(a in this.shapes){this.shapes[a].Stop()}};Frame.prototype.StopInput=function(a){if(!this.Owns(a)){return}this.Shape(a).StopInput()};Frame.prototype.SubmitInput=function(a){if(!this.Owns(a)){return}this.Shape(a).SubmitInput()};Frame.prototype.HideFailureMessages=function(a){if(!this.Owns(a)){return}this.Shape(a).HideFailureMessages()};Frame.prototype.UpdateBackground=function(){var a;if(this.backgrounds.length<=0){return}a=this.variables.Get("CurrentBackgroundIndex");if(a<this.backgrounds.length-1){this.backgrounds[a].visibility="Collapsed";a=this.variables.Increment("CurrentBackgroundIndex");this.backgrounds[a].visibility="Visible";if(a<this.backgrounds.length-1){this.animations.TryBegin("BackgroundUpdateTimer")}}};Frame.prototype.OnCursorClick=function(a){if(!this.Owns(a)){return}this.Shape(a).OnCursorClick()};Frame.prototype.BeginTyping=function(a){if(!this.Owns(a)){return}this.Shape(a).BeginTyping()};Frame.prototype.BeginSoundObject=function(a){if(!this.Owns(a)){return}if(this.soundObjects.TryBegin(a)){var b=this.soundObjects.Get(a);Movie.playingSounds.AddMediaElement(b,a,Enum.PlayableState.Active);Movie.previousFramesSounds.AddMediaElement(b,a,Enum.PlayableState.Active)}};Frame.prototype.OnShapeMouseLeftDown=function(a){if(!this.Owns(a)){return}this.Shape(a).OnMouseLeftDown()};Frame.prototype.OnShapeMouseLeftUp=function(a){if(!this.Owns(a)){return}this.Shape(a).OnMouseLeftUp()};Frame.prototype.OnShapeMouseEnter=function(a){if(!this.Owns(a)){return}this.Shape(a).OnMouseEnter()};Frame.prototype.OnShapeMouseLeave=function(a){if(!this.Owns(a)){return}this.Shape(a).OnMouseLeave()};Frame.prototype.OnShapeAnimationCompleted=function(a){if(!this.Owns(a)){return}this.Shape(a).OnShapeAnimationCompleted()};Frame.prototype.OnSuccessMessageCompleted=function(){var a=this.variables.Get("ShapeAwaitingMessageCompletion");if(a!=null){a.OnSuccessMessageCompleted()}};Enum.ActionFunc={GotoFrame:"GotoFrame",GotoFirst:"GotoFirst",GotoNext:"GotoNext",GotoPrevious:"GotoPrevious",StartCursor:"StartCursor",Pause:"Pause",Accept:"Accept",Open:"Open",OpenWithDefault:"OpenWithDefault"};var Movie={root:null,host:null,frames:null,lastFrameIndex:null,currentFrameIndex:null,endActionFunc:null,endActionArg:null,paused:false,playingSounds:new Playables(),previousFramesSounds:new Playables(),htmlInputForm:null};Movie.HtmlInputField=function(){return Movie.htmlInputForm.elements[0]};Movie.Host=function(){if(Movie.host==null&&Movie.root!=null){Movie.host=Movie.root.getHost()}return Movie.host};Movie.FirstFrameIndex=function(){return 1};Movie.LastFrameIndex=function(){return Movie.lastFrameIndex};Movie.CurrentFrame=function(){return Movie.frames[Movie.currentFrameIndex]};Movie.PreviousFrame=function(){return Movie.frames[Movie.currentFrameIndex-1]};Movie.InputInProgress=function(){return Movie.htmlInputForm.style.display!="none"};Movie.TogglePause=function(){if(Movie.pendingFrame!=null){return}Movie.playingSounds.TryTogglePause();Movie.CurrentFrame().TogglePauseAnimations();Movie.paused=!Movie.paused};Movie.GotoFrame=function(d){var b;var a;var c=null;if(typeof d=="string"){c=parseInt(d)}else{if(typeof d=="number"){c=d}}if(c==null){throw"invalid frame"}if(c<Movie.FirstFrameIndex()||c>Movie.LastFrameIndex()){return}if(Movie.frames[c]==null){Movie.PauseForLoading(c);return}if(Movie.currentFrameIndex!=null){Movie.CurrentFrame().Stop();Movie.CurrentFrame().Hide();if(Movie.currentFrameIndex>Movie.FirstFrameIndex()&&Movie.PreviousFrame()!=null){Movie.PreviousFrame().Hide()}}Movie.currentFrameIndex=c;if(Movie.CurrentFrame().stopPreviousSound){Movie.previousFramesSounds.TryStop();Movie.previousFramesSounds.RemoveFrom(Movie.playingSounds);Movie.previousFramesSounds.RemoveAll()}if(Movie.currentFrameIndex>Movie.FirstFrameIndex()&&Movie.PreviousFrame()!=null){Movie.PreviousFrame().ShowEnd()}Movie.CurrentFrame().Show();Movie.CurrentFrame().Start()};Movie.GotoNext=function(){Movie.GotoFrame(Movie.currentFrameIndex+1)};Movie.GotoPrevious=function(){Movie.GotoFrame(Movie.currentFrameIndex-1)};Movie.GotoFirst=function(){var a=Movie.playingSounds.Get("MovieSound");Movie.playingSounds.TryStop();Movie.playingSounds.RemoveAll();Movie.previousFramesSounds.RemoveAll();if(a!=null){Movie.playingSounds.AddMediaElement(a,"MovieSound",Enum.PlayableState.Stopped)}if(!this.playingSounds.IsReady()){Movie.BeginLoadingAnimation();setTimeout(function(){Movie.GotoFirst()},100)}else{Movie.TryEndLoadingAnimation()}Movie.playingSounds.TryBegin();Movie.GotoFrame(Movie.FirstFrameIndex())};Movie.GotoLast=function(){Movie.GotoFrame(Movie.LastFrameIndex())};Movie.Start=function(d,c,a){var b;var e;var f;Movie.root=a;Movie.htmlInputForm=document.getElementById(Helper.GetDefaultInputId());for(b=0;;b++){e=a.FindName(Helper.GetTextName(b));if(e==null){break}Helper.AlignText(e,e.Tag.split(" ")[0])}Movie.playingSounds.AddMediaElement(a.FindName(Helper.GetSoundName()),"MovieSound",Enum.PlayableState.Stopped);f=Helper.GetObjectInfo(a);if(f!=null){Movie.endActionFunc=f.endAction;Movie.endActionArg=f.endActionArg;Movie.framesToPreload=f.framesToPreload}Movie.frames=new Array();for(b=0;;b++){Movie.frames.push(new Frame(b,a));if(Movie.frames[b].canvas==null){Movie.frames.pop();break}}Movie.StartDownloadingFiles()};Movie.DoAction=function(b,a){switch(b){case Enum.ActionFunc.GotoFrame:Movie.GotoFrame(a);break;case Enum.ActionFunc.GotoFirst:Movie.GotoFirst();break;case Enum.ActionFunc.GotoNext:Movie.GotoNext();break;case Enum.ActionFunc.GotoPrevious:Movie.GotoPrevious();break;case Enum.ActionFunc.Pause:Movie.TogglePause();break;case Enum.ActionFunc.Open:window.location=a;break;case Enum.ActionFunc.OpenWithDefault:window.open(a,"_default");break}};Movie.BeginLoadingAnimation=function(){Movie.playingSounds.TryPause();if(Movie.loadingAnimation==null){Movie.loadingAnimation=Movie.root.FindName(Helper.GetLoadingAnimationName());Movie.loadingCanvas=Movie.root.FindName(Helper.GetLoadingCanvasName())}Movie.loadingAnimation.Begin();Movie.loadingCanvas.Visibility="Visible"};Movie.TryEndLoadingAnimation=function(){if(Movie.loadingCanvas==null||Movie.loadingAnimation==null){return false}Movie.loadingCanvas.Visibility="Collapsed";Movie.loadingAnimation.Stop();Movie.playingSounds.TryResume();return true};Movie.PauseForLoading=function(a){Movie.awaitingFrameLoad=true;Movie.pendingFrame=a;Movie.BeginLoadingAnimation()};Movie.TryResumeFromLoading=function(a){if(Movie.pendingFrame==a){Movie.TryEndLoadingAnimation();Movie.GotoFrame(Movie.pendingFrame);Movie.pendingFrame=null;return true}else{return false}};Movie.UpdateProgressBars=function(c,f){var e;var g;var a;if(f==0){a="100%"}else{a=Math.round(c/f*100)+"%"}var b=document.getElementsByName("progressLoaded");for(e=0;e<b.length;e++){g=b[e];g.style.width=a}var d=document.getElementsByName("progressText");for(e=0;e<d.length;e++){g=d[e];g.innerHTML=a}};Movie.RemoveProgressBars=function(){var c;var b;var a=document.getElementsByName("progressBarContainer");for(c=a.length-1;c>=0;c--){b=a[c];b.parentNode.removeChild(b)}delete Movie.UpdateProgressBars;delete Movie.RemoveProgressBars};Movie.RemoveCenterScreenProgressBar=function(){var c;var b;var a=document.getElementsByName("progressBarContainer");for(c=a.length-1;c>=0;c--){b=a[c];if(b.tagName.toLowerCase()=="tr"){b.parentNode.removeChild(b)}}delete Movie.RemoveCenterScreenProgressBar};Movie.StartDownloadingFiles=function(){var a;var b;Movie.InitFilesToDownload();Movie.lastFrameIndex=Movie.filesToDownload.length-1;Movie.loadProgressCurrent=0;Movie.loadProgressTotal=0;for(a=0;a<Movie.filesToDownload.length;a++){if(typeof Movie.filesToDownload[a]=="object"){Movie.loadProgressTotal+=Movie.filesToDownload[a].length}}b=Movie.GetNextFileToDownload();if(b!=null){Movie.filesDownloaded=new Object();if(Helper.IsOnline()){Movie.resourceDownloader=Movie.Host().createObject("downloader");Movie.resourceDownloader.addEventListener("completed",Movie.OnFileDownloaded);Movie.resourceDownloader.addEventListener("downloadProgressChanged",Movie.OnFileDownloadProgressUpdate)}Movie.DownloadFile(b)}else{delete Movie.loadProgressCurrent;delete Movie.loadProgressTotal;Movie.RemoveProgressBars();Movie.InitiateFirstFrameAndSound()}};Movie.OnFileDownloadProgressUpdate=function(b,a){Movie.UpdateProgressBars(Movie.loadProgressCurrent+b.downloadProgress,Movie.loadProgressTotal)};Movie.InitiateFirstFrameAndSound=function(){Movie.GotoFirst()};Movie.DownloadFile=function(a){if(a.substring(a.length-3,a.length)==".js"){Movie.loadingXaml=true;CMCXmlParser.GetXmlDoc(a,true,Movie.OnFileDownloaded)}else{Movie.loadingXaml=false;if(Helper.IsOnline()){Movie.resourceDownloader.open("GET",a);Movie.resourceDownloader.send()}else{setTimeout(function(){Movie.OnFileDownloaded()},5)}}};Movie.OnFileDownloaded=function(d,a){var e;var b;var c;if(Movie.loadingXaml==true){Movie.root.children.add(Movie.Host().content.createFromXaml(d));e=Movie.currentFrameLoadIndex;Movie.frames[e]=new Frame(e,Movie.root);setTimeout(function(){Movie.TryResumeFromLoading(e)},1000);if(e==Movie.framesToPreload){Movie.RemoveCenterScreenProgressBar();Movie.InitiateFirstFrameAndSound()}}b=Movie.filesToDownload[Movie.currentFrameLoadIndex][Movie.currentFileLoadIndex];Movie.filesDownloaded[b]=true;Movie.loadProgressCurrent++;Movie.UpdateProgressBars(Movie.loadProgressCurrent,Movie.loadProgressTotal);c=Movie.GetNextFileToDownload();while(c!=null&&Movie.filesDownloaded[c]==true){c=Movie.GetNextFileToDownload()}if(c!=null){setTimeout(function(){Movie.DownloadFile(c)},10)}else{Movie.RemoveProgressBars();delete Movie.loadProgressCurrent;delete Movie.loadProgressTotal;delete Movie.resourceDownloader;delete Movie.filesDownloaded;delete Movie.loadingXaml;delete Movie.filesToDownload;delete Movie.currentFrameLoadIndex;delete Movie.currentFileLoadIndex;delete Movie.awaitingFrameLoad;delete Movie.Start;delete Movie.StartDownloadingFiles;delete Movie.OnFileDownloadProgressUpdate;delete Movie.DownloadFile;delete Movie.OnFileDownloaded;delete Movie.GetNextFileToDownload}};Movie.GetNextFileToDownload=function(){var a;var b;try{Movie.currentFileLoadIndex++}catch(b){Movie.currentFrameLoadIndex=0;Movie.currentFileLoadIndex=0}if(Movie.awaitingFrameLoad==true){Movie.currentFrameLoadIndex=Movie.pendingFrame;Movie.currentFileLoadIndex=0;Movie.awaitingFrameLoad=false}if(typeof Movie.filesToDownload[Movie.currentFrameLoadIndex]=="object"&&Movie.currentFileLoadIndex>=Movie.filesToDownload[Movie.currentFrameLoadIndex].length){Movie.filesToDownload[Movie.currentFrameLoadIndex]="frame loaded"}if(typeof Movie.filesToDownload[Movie.currentFrameLoadIndex]!="object"){for(a=Movie.currentFrameLoadIndex;a<Movie.filesToDownload.length;a++){if(typeof Movie.filesToDownload[a]=="object"){Movie.currentFrameLoadIndex=a;Movie.currentFileLoadIndex=0;break}}}if(typeof Movie.filesToDownload[Movie.currentFrameLoadIndex]!="object"){for(a=0;a<Movie.filesToDownload.length;a++){if(typeof Movie.filesToDownload[a]=="object"){Movie.currentFrameLoadIndex=a;Movie.currentFileLoadIndex=0;break}}}if(typeof Movie.filesToDownload[Movie.currentFrameLoadIndex]!="object"){return null}return Movie.filesToDownload[Movie.currentFrameLoadIndex][Movie.currentFileLoadIndex]};Movie.OnSilverlightError=function(b,a){};Movie.OnFrameCompleted=function(b,a){if(Movie.currentFrameIndex==Movie.LastFrameIndex()){Movie.DoAction(Movie.endActionFunc,Movie.endActionArg)}else{Movie.GotoNext()}};Movie.OnFrameBackgroundUpdate=function(b,a){Movie.CurrentFrame().UpdateBackground()};Movie.OnInputFieldKeyDown=function(){if(Movie.InputInProgress()){Movie.CurrentFrame().HideFailureMessages(Movie.htmlInputForm.id)}return true};Movie.OnInputFieldBlur=function(a){if(Movie.InputInProgress()){Movie.CurrentFrame().StopInput(Movie.htmlInputForm.id)}};Movie.OnInputFormSubmit=function(){if(Movie.InputInProgress()){Movie.CurrentFrame().SubmitInput(Movie.htmlInputForm.id)}};Movie.OnShapeForegroundMouseLeftDown=function(b,a){Movie.CurrentFrame().OnShapeMouseLeftDown(b.GetParent().Name)};Movie.OnShapeForegroundMouseLeftUp=function(b,a){Movie.CurrentFrame().OnShapeMouseLeftUp(b.GetParent().Name)};Movie.OnShapeForegroundMouseEnter=function(b,a){Movie.CurrentFrame().OnShapeMouseEnter(b.GetParent().Name)};Movie.OnShapeForegroundMouseLeave=function(b,a){Movie.CurrentFrame().OnShapeMouseLeave(b.GetParent().Name)};Movie.OnShapeAnimationCompleted=function(a,b){var c=Helper.ExtractShapeName(a.Name);Movie.CurrentFrame().OnShapeAnimationCompleted(c)};Movie.OnSuccessMessageCompleted=function(b,a){Movie.CurrentFrame().OnSuccessMessageCompleted()};Movie.OnCursorClick=function(c,a){var b=Helper.ExtractShapeName(c.Name);Movie.CurrentFrame().OnCursorClick(b)};Movie.OnTypingBegin=function(c,a){var b=Helper.ExtractShapeName(c.Name);Movie.CurrentFrame().BeginTyping(b)};Movie.OnSoundObjectBegin=function(c,b){var a=Helper.ExtractSoundObjectName(c.Name);Movie.CurrentFrame().BeginSoundObject(a)};Movie.OnObjectSoundEnded=function(a,b){Movie.playingSounds.Remove(a.Name)};function FMimicReplayMediaElement(b,a){Helper.ReplayMediaElement(b)}function FMimicOnShapeForegroundMouseLeftDown(b,a){Movie.OnShapeForegroundMouseLeftDown(b,a)}function FMimicOnShapeForegroundMouseLeftUp(b,a){Movie.OnShapeForegroundMouseLeftUp(b,a)}function FMimicOnShapeForegroundMouseEnter(b,a){Movie.OnShapeForegroundMouseEnter(b,a)}function FMimicOnShapeForegroundMouseLeave(b,a){Movie.OnShapeForegroundMouseLeave(b,a)}function FMimicOnShapeAnimationCompleted(b,a){Movie.OnShapeAnimationCompleted(b,a)}function FMimicOnFailureMessageCompleted(b,a){}function FMimicOnSuccessMessageCompleted(b,a){Movie.OnSuccessMessageCompleted(b,a)}function FMimicOnCursorClick(b,a){Movie.OnCursorClick(b,a)}function FMimicOnTypingBegin(b,a){Movie.OnTypingBegin(b,a)}function FMimicOnSoundObjectBegin(b,a){Movie.OnSoundObjectBegin(b,a)}function FMimicOnFrameBackgroundUpdate(b,a){Movie.OnFrameBackgroundUpdate(b,a)}function FMimicOnFrameCompleted(b,a){Movie.OnFrameCompleted(b,a)}function FMimicOnObjectSoundEnded(b,a){Movie.OnObjectSoundEnded(b,a)}var mcButtons=new Array();function FMimicAboutBox(a){window.open(a.getAttribute("mcAboutPage"),"mAbout",a.getAttribute("mcAboutWindowCommands"))}function FMimicHomePage(a){document.location.href=a.getAttribute("mcHome")}function FMimicGotoSection(a){document.location.href=a.getAttribute("mcSection")}function FMimicOnSelectSection(a){document.location.href=a.options[a.selectedIndex].getAttribute("value")}function FMimicGotoNext(b,a){Movie.GotoNext()}function FMimicGotoPrev(b,a){Movie.GotoPrevious()}function FMimicGotoFirst(b,a){Movie.GotoFirst()}function FMimicGotoLast(b,a){Movie.GotoLast()}function FMimicPause(b,a){if(typeof(Movie.paused)=="boolean"){Movie.TogglePause();FMimicCheckButton(document.body,"Pause",Movie.paused)}}function FMimicUpdateUI(d){if(typeof(gMCInPreview)!="undefined"&&gMCInPreview){return}var a=d.split(":");var e=a[0];var b=a[1];var c=a[2];FMimicEnableButton(document.body,"First",b>0);FMimicEnableButton(document.body,"Back",e>0);FMimicEnableButton(document.body,"Forward",e<b-1);FMimicEnableButton(document.body,"Pause",e<b);FMimicCheckButton(document.body,"Pause",c==1)}function FMimicEnableButton(d,c,b){for(var a in FMimicGetButtons(d,c)){if(!b==a.disabled){return}a.disabled=!b;if(a.disabled){FResetStyleAttributes(a)}return true}}function FMimicCollectButtons(c,a,d){if(c.getAttribute("mcControlType")==a){d[d.length]=c;return true}for(var b=0;b<c.childNodes.length;b++){var e=c.childNodes[b];if(e.nodeType!=1){continue}FMimicCollectButtons(e,a,d)}return false}function FMimicGetButtons(b,a){if(mcButtons[a]!=null){return mcButtons[a]}mcButtons[a]=new Array();FMimicCollectButtons(b,a,mcButtons[a]);return mcButtons[a]}function FMimicCheckButton(e,b,a){var d=FMimicGetButtons(e,b);for(var c=0;c<d.length;c++){FCheckItem(d[c],a);return true}return false}function FAddToLog(a){var b=document.getElementById("log");if(b==null||typeof(b)=="undefined"){return}b.appendChild(document.createTextNode(a));b.appendChild(document.createElement("br"));b.childNodes[b.childNodes.length-1].scrollIntoView()};function FSetStyleAttributes(b,a){FSetStyleAttribute(b,"color",a);FSetStyleAttribute(b,"fontSize",a);FSetStyleAttribute(b,"fontWeight",a);FSetStyleAttribute(b,"fontStyle",a);FSetStyleAttribute(b,"borderLeft",a);FSetStyleAttribute(b,"borderRight",a);FSetStyleAttribute(b,"borderTop",a);FSetStyleAttribute(b,"borderBottom",a);FSetStyleAttribute(b,"backgroundColor",a);FSetStyleAttribute(b,"backgroundImage",a)}function FResetStyleAttributes(a){a.mcState=null;if(a.mcChecked){FSetStyleAttributes(a,"Checked");return}FResetStyleAttribute(a,"color");FResetStyleAttribute(a,"fontSize");FResetStyleAttribute(a,"fontWeight");FResetStyleAttribute(a,"fontStyle");FResetStyleAttribute(a,"borderLeft");FResetStyleAttribute(a,"borderRight");FResetStyleAttribute(a,"borderTop");FResetStyleAttribute(a,"borderBottom");FResetStyleAttribute(a,"backgroundColor");FResetStyleAttribute(a,"backgroundImage")}function FMimicOnMouseOver(a){if(a.mcState!="Pressed"){FSetStyleAttributes(a,"Hover");a.mcState="Hover"}}function FMimicOnMouseDown(a){FResetStyleAttributes(a);FSetStyleAttributes(a,"Pressed");a.mcState="Pressed"}function FMimicOnMouseUp(a){FResetStyleAttributes(a);FSetStyleAttributes(a,"Hover");a.mcState="Hover"}function FMimicOnMouseOut(b,c){var a=b.relatedTarget||b.toElement;if(!FIsSubNode(a,c)){FResetStyleAttributes(c)}}function FIsSubNode(c,b){if(c==null){return null}for(var a=c;;a=a.parentNode){if(a==b){return true}if(a==document.body){return false}}}function FMimicGetPosition(c){var a=0;var b=0;if(c.offsetParent){a=c.offsetTop;b=c.offsetLeft;while(c=c.offsetParent){a+=c.offsetTop;b+=c.offsetLeft}}return{x:b,y:a}}function FMimicGetMousePosition(a){if(typeof(a.pageX)!="undefined"){return{x:a.pageX,y:a.pageY}}else{if(typeof(a.clientX)!="undefined"){return{x:a.clientX,y:a.clientY}}}}function FMimicGetComputedStyle(c,b){var d=null;if(c.currentStyle){d=c.currentStyle[b]}else{if(document.defaultView&&document.defaultView.getComputedStyle){var a=document.defaultView.getComputedStyle(c,null);if(a){d=a[b]}}}return d}function FCheckItem(b,a){b.mcChecked=a;FResetStyleAttributes(b);if(b.mcState!=null){FSetStyleAttributes(b,b.mcState)}}function FSetStyleAttribute(c,h,d){var g=h+d;var f=FFindAttributeHolder(c,g);if(f==null){return}var e=f.getAttribute(g);if(e==null){return}var a=h+"_saved";var b=FGetStyle(f,h);if(f.getAttribute(a)==null){f.setAttribute(a,b)}f.style[h]=e;if(FDistributableProp(h)){FDistributeStyleAttribute(f,h,e)}}function FDistributableProp(a){if(a=="color"){return true}if(a=="textDecoration"){return true}if(a=="font"){return true}if(a=="fontFamily"){return true}if(a=="fontSize"){return true}if(a=="fontStyle"){return true}if(a=="fontWeight"){return true}return false}function FResetStyleAttribute(b,e){var a=e+"_saved";var d=FFindAttributeHolder(b,a);if(d==null){return}var c=d.getAttribute(a);if(c==null){return}d.style[e]=c;if(FDistributableProp(e)){FDistributeStyleAttribute(d,e,c)}}function FGetStyle(a,b){return FMimicGetComputedStyle(a,b)}function FSetStyle(b,c,a){b.style[c]=a}function FDistributeStyleAttribute(c,e,b){for(var a=0;a<c.childNodes.length;a++){var d=c.childNodes[a];if(d.nodeType!=1){continue}FSetStyle(d,e,b);FDistributeStyleAttribute(d,e,b)}}function FFindAttributeHolder(d,f){var c=d.getAttribute(f);if(c!=null){return d}for(var b=0;b<d.childNodes.length;b++){var e=d.childNodes[b];if(e.nodeType!=1){continue}var a=FFindAttributeHolder(e,f);if(a!=null){return a}}return null};/*]]>*/</script>
        <script type="text/javascript">/*<![CDATA[*/
Movie.InitFilesToDownload=function(){Movie.filesToDownload=['frame loaded',['Data/Images/0.png','Data/Images/text35f608775774b123a53f0717b031563362786750.png','Data/Images/textaf15be0869240ca5581a3368b6ecda9b3dfac709.png','Data/Images/text99aabdfc068a525b098a16b80fb0daea4e58e543.png','Data/Images/textd8d17d3002bf791a1a52cd9bd7d3733ce0c36032.png','Data/Images/text2c0fbf12cab518337d098a004808474b3ee4cddc.png','Data/Js/Frame_1.js'],['Data/Images/0.png','Data/Images/text35f608775774b123a53f0717b031563362786750.png','Data/Images/textaf15be0869240ca5581a3368b6ecda9b3dfac709.png','Data/Images/text99aabdfc068a525b098a16b80fb0daea4e58e543.png','Data/Images/textd8d17d3002bf791a1a52cd9bd7d3733ce0c36032.png','Data/Images/text2c0fbf12cab518337d098a004808474b3ee4cddc.png','Data/Js/Frame_2.js'],['Data/Images/0.png','Data/Images/text35f608775774b123a53f0717b031563362786750.png','Data/Images/textaf15be0869240ca5581a3368b6ecda9b3dfac709.png','Data/Images/text99aabdfc068a525b098a16b80fb0daea4e58e543.png','Data/Images/textd8d17d3002bf791a1a52cd9bd7d3733ce0c36032.png','Data/Images/text2c0fbf12cab518337d098a004808474b3ee4cddc.png','Data/Js/Frame_3.js']];};/*]]>*/</script>
    </head>
    <body leftmargin="0" topmargin="0" style="margin: 0;">
        <center>
            <table cellpadding="0" style="background-color: white; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; border-collapse: collapse;">
                <tr name="progressBarContainer" id="progressBarContainer">
                    <td style="text-align: center;">
                        <div style="font-family: Arial; font-size: 16px; font-weight: normal; font-style: normal; color: black;">
                        </div>
                        <div title="Loading Progress" style="width: 35px; height: 14px; position: relative; margin: auto;">
                            <div style="width: 100%; height: 50%; background-color: #E2E2E2; font-size: 1px;"> </div>
                            <div style="width: 100%; height: 50%; background-color: #C9C9C9; font-size: 1px;"> </div>
                            <div name="progressLoaded" id="progressLoaded" style="position: absolute; left: 0; top: 0; width: 0%; height: 100%; font-size: 1px;">
                                <div style="width: 100%; height: 50%; background-color: #72F777;"> </div>
                                <div style="width: 100%; height: 50%; background-color: #40C945;"> </div>
                            </div>
                            <div name="progressText" id="progressText" style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; text-align: center; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: black;"> </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div style="position: relative; width: 618; height: 526;">
                            <div id="MimicMovieHost">
                                <script type="text/javascript">/*<![CDATA[*/Silverlight.createObjectEx({source: 'oneFrame.xaml', parentElement: document.getElementById('MimicMovieHost'), properties: {width: '618', height: '526', isWindowless: 'true', version: '2.0'}, events: { onLoad: Movie.Start, onError: Movie.OnSilverlightError }});/*]]>*/</script>
                            </div>
                            <form id="MimicInputForm" action="javascript:Movie.OnInputFormSubmit();" style="display: none; position: absolute;">
                                <input type="text" onkeydown="return Movie.OnInputFieldKeyDown();" style="border: 0px; background: transparent; position: absolute;" />
                            </form>
                        </div>
                    </td>
                </tr>
            </table>
        </center>
        <center>
            <table style="border-collapse: collapse; border-spacing: 0px; width: 618; background-color: white; border-left: solid 1px black; border-right: solid 1px black; border-top: solid 1px black; border-bottom: solid 1px black; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 0px;" cellpadding="0" cellspacing="0" id="toolbar">
                <col style="width: 35px;" />
                <col style="width: 35px;" />
                <col style="width: 35px;" />
                <col style="width: 35px;" />
                <col name="progressBarContainer" id="progressBarContainer" style="width: 35px;" />
                <col style="width: auto;" />
                <col style="width: 120px;" />
                <tr style="height: 32px;">
                    <td mcControlType="Pause" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" backgroundColorChecked="#dedede" colorHover="white" colorPressed="black" colorChecked="white" onmouseover="FMimicOnMouseOver(this)" onmouseout="FMimicOnMouseOut(event, this)" onmousedown="FMimicOnMouseDown(this)" onmouseup="FMimicOnMouseUp(this)" onclick="FMimicPause();">
                        <div style="position: relative;">
                            <button style="border: none; background-color: Transparent; cursor: default; height: 32px; width: 35px;" title="Pause">
                                <table cellpadding="0" cellspacing="0" style="width: 35px; position: absolute; left: 0px; top: 0px;">
                                    <tr style="height: 32px;">
                                        <td>
                                            <div style="width: 100%; height: 26px; background-image: url('Data/MC__4982930A.png'); background-repeat: no-repeat; background-position: center;" backgroundImagePressed="url('Data/MC__5C187F2D.png')" backgroundImageHover="url('Data/MC__2A4636AB.png')" backgroundImageChecked="url('Data/MC__5C187F2D.png')">
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                    </td>
                    <td mcControlType="First" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="white" colorPressed="black" onmouseover="FMimicOnMouseOver(this)" onmouseout="FMimicOnMouseOut(event, this)" onmousedown="FMimicOnMouseDown(this)" onmouseup="FMimicOnMouseUp(this)" onclick="FMimicGotoFirst();">
                        <div style="position: relative;">
                            <button style="border: none; background-color: Transparent; cursor: default; height: 32px; width: 35px;" title="First">
                                <table cellpadding="0" cellspacing="0" style="width: 35px; position: absolute; left: 0px; top: 0px;">
                                    <tr style="height: 32px;">
                                        <td>
                                            <div style="width: 100%; height: 26px; background-image: url('Data/MC__143B3B26.png'); background-repeat: no-repeat; background-position: center;" backgroundImagePressed="url('Data/MC__2B68DB11.png')" backgroundImageHover="url('Data/MC__50B07BEB.png')" backgroundImageChecked="url('Data/First.gif')">
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                    </td>
                    <td mcControlType="Back" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="white" colorPressed="black" onmouseover="FMimicOnMouseOver(this)" onmouseout="FMimicOnMouseOut(event, this)" onmousedown="FMimicOnMouseDown(this)" onmouseup="FMimicOnMouseUp(this)" onclick="FMimicGotoPrev();">
                        <div style="position: relative;">
                            <button style="border: none; background-color: Transparent; cursor: default; height: 32px; width: 35px;" title="Back">
                                <table cellpadding="0" cellspacing="0" style="width: 35px; position: absolute; left: 0px; top: 0px;">
                                    <tr style="height: 32px;">
                                        <td>
                                            <div style="width: 100%; height: 26px; background-image: url('Data/MC__4509BC52.png'); background-repeat: no-repeat; background-position: center;" backgroundImagePressed="url('Data/MC__15C61559.png')" backgroundImageHover="url('Data/MC__15610DD7.png')" backgroundImageChecked="url('Data/Back.gif')">
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                    </td>
                    <td mcControlType="Forward" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="white" colorPressed="black" onmouseover="FMimicOnMouseOver(this)" onmouseout="FMimicOnMouseOut(event, this)" onmousedown="FMimicOnMouseDown(this)" onmouseup="FMimicOnMouseUp(this)" onclick="FMimicGotoNext();">
                        <div style="position: relative;">
                            <button style="border: none; background-color: Transparent; cursor: default; height: 32px; width: 35px;" title="Forward">
                                <table cellpadding="0" cellspacing="0" style="width: 35px; position: absolute; left: 0px; top: 0px;">
                                    <tr style="height: 32px;">
                                        <td>
                                            <div style="width: 100%; height: 26px; background-image: url('Data/MC__BEFC49C.png'); background-repeat: no-repeat; background-position: center;" backgroundImagePressed="url('Data/MC__2F29BC2F.png')" backgroundImageHover="url('Data/MC__4DD7B3FE.png')" backgroundImageChecked="url('Data/Forward.gif')">
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                    </td>
                    <td mcControlType="ProgressBar" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 16px; font-weight: normal; font-style: normal; color: black; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="none" colorPressed="none" name="progressBarContainer" id="progressBarContainer">
                        <div title="Loading Progress" style="width: 35px; height: 14px; position: relative; margin: auto;">
                            <div style="width: 100%; height: 50%; background-color: #E2E2E2; font-size: 1px;"> </div>
                            <div style="width: 100%; height: 50%; background-color: #C9C9C9; font-size: 1px;"> </div>
                            <div name="progressLoaded" id="progressLoaded" style="position: absolute; left: 0; top: 0; width: 0%; height: 100%; font-size: 1px;">
                                <div style="width: 100%; height: 50%; background-color: #72F777;"> </div>
                                <div style="width: 100%; height: 50%; background-color: #40C945;"> </div>
                            </div>
                            <div name="progressText" id="progressText" style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; text-align: center; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: black;"> </div>
                        </div>
                    </td>
                    <td mcControlType="Filler" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="white" colorPressed="black">&#160;</td>
                    <td mcControlType="Logo" style="background-color: #dedede; border-left: none; border-right: none; border-top: none; border-bottom: none; padding-left: 0px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 10px; font-weight: normal; font-style: normal; color: normal; text-align: center;" backgroundColorHover="#dedede" backgroundColorPressed="#dedede" colorHover="white" colorPressed="black" mcAboutPage="Data/About.htm" mcAboutWindowCommands="status=0,menubar=0,resizable=0,scrollbars=0,width=319,height=317" onmouseover="FMimicOnMouseOver(this)" onmouseout="FMimicOnMouseOut(event, this)" onmousedown="FMimicOnMouseDown(this)" onmouseup="FMimicOnMouseUp(this)" onclick="FMimicAboutBox(this);">
                        <div style="position: relative;">
                            <button style="border: none; background-color: Transparent; cursor: default; height: 32px; width: 120px;">
                                <table cellpadding="0" cellspacing="0" style="width: 120px; position: absolute; left: 0px; top: 0px;">
                                    <tr style="height: 32px;">
                                        <td>
                                            <div style="width: 100%; height: 24px; background-image: url('Data/Logo.gif'); background-repeat: no-repeat; background-position: center;" backgroundImagePressed="url('Data/Logo.gif')" backgroundImageHover="url('Data/Logo.gif')" backgroundImageChecked="url('Data/Logo.gif')">
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </button>
                        </div>
                    </td>
                </tr>
            </table>
        </center>
    </body>
</html>